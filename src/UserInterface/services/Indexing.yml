parameters:


services:
    indexDatabase:
        class: PhpIntegrator\Indexing\IndexDatabase

    classlikeInfoBuilderProvider.backend:
        alias: indexDatabase

    builtinIndexer:
        class: PhpIntegrator\Indexing\BuiltinIndexer
        arguments:
            - '@indexDatabase'
            - '@typeAnalyzer'
            - '@partialParser'
            - '@nodeTypeDeducer'

    fileIndexerFactory.backend.fileTypeResolverFactory:
        class: PhpIntegrator\Analysis\Typing\Resolving\FileTypeResolverFactory
        arguments:
            - '@typeResolver'
            - '@namespaceImportProvider.backend'
            - '@fileLineNamespaceDeterminerFactory'

    fileIndexerFactory.backend:
        class: PhpIntegrator\Indexing\FileIndexerFactory
        arguments:
            - '@storageForIndexers'
            - '@docblockParser'
            - '@typeAnalyzer'
            - '@typeResolver'
            - '@parser'
            - '@nodeTypeDeducer'
            - '@fileIndexerFactory.backend.fileTypeResolverFactory'

    cachingFileIndexerFactory.cache:
        class: Doctrine\Common\Cache\ArrayCache

    cachingFileIndexerFactory:
        class: PhpIntegrator\Indexing\CachingFileIndexerFactory
        arguments:
            - '@fileIndexerFactory.backend'
            - '@cachingFileIndexerFactory.cache'

    fileIndexerFactory:
        alias: cachingFileIndexerFactory

    projectIndexer:
        class: PhpIntegrator\Indexing\ProjectIndexer
        arguments:
            - '@storageForIndexers'
            - '@fileIndexerFactory'
            - '@sourceCodeStreamReader'

    indexer:
        class: PhpIntegrator\Indexing\Indexer
        arguments:
            - '@projectIndexer'
            - '@sourceCodeStreamReader'
